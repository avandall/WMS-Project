graph TB
    subgraph "Client Layer"
        Browser[Web Browser/API Client]
    end
    
    subgraph "API Layer - FastAPI"
        API[FastAPI Application]
        MW1[Request ID Middleware]
        MW2[CORS Middleware]
        MW3[Rate Limiter]
        Health[Health Check Endpoint]
        
        API --> MW1
        API --> MW2
        API --> MW3
        API --> Health
    end
    
    subgraph "API Routers"
        ProdRouter[Products Router]
        WhRouter[Warehouses Router]
        InvRouter[Inventory Router]
        DocRouter[Documents Router]
        RepRouter[Reports Router]
    end
    
    subgraph "Service Layer"
        ProdService[Product Service]
        WhService[Warehouse Service]
        InvService[Inventory Service]
        DocService[Document Service]
        RepService[Report Service]
    end
    
    subgraph "Domain Layer"
        ProdDomain[Product Domain]
        WhDomain[Warehouse Domain]
        InvDomain[Inventory Domain]
        DocDomain[Document Domain]
    end
    
    subgraph "Repository Layer"
        ProdRepo[Product Repository]
        WhRepo[Warehouse Repository]
        InvRepo[Inventory Repository]
        DocRepo[Document Repository]
    end
    
    subgraph "Infrastructure"
        DB[(PostgreSQL Database)]
        Pool[Connection Pool<br/>20+10 connections]
        Logging[Structured Logging]
        Transaction[Transaction Manager]
    end
    
    Browser --> API
    
    API --> ProdRouter
    API --> WhRouter
    API --> InvRouter
    API --> DocRouter
    API --> RepRouter
    
    ProdRouter --> ProdService
    WhRouter --> WhService
    InvRouter --> InvService
    DocRouter --> DocService
    RepRouter --> RepService
    
    ProdService --> ProdDomain
    WhService --> WhDomain
    InvService --> InvDomain
    DocService --> DocDomain
    
    ProdService --> ProdRepo
    WhService --> WhRepo
    InvService --> InvRepo
    DocService --> DocRepo
    DocService --> WhRepo
    DocService --> InvRepo
    
    ProdRepo --> Pool
    WhRepo --> Pool
    InvRepo --> Pool
    DocRepo --> Pool
    
    Pool --> DB
    
    ProdService -.-> Logging
    WhService -.-> Logging
    InvService -.-> Logging
    DocService -.-> Logging
    DocService -.-> Transaction
    
    style API fill:#4CAF50,stroke:#2E7D32,color:#fff
    style Browser fill:#2196F3,stroke:#1565C0,color:#fff
    style DB fill:#FF9800,stroke:#E65100,color:#fff
    style Transaction fill:#E91E63,stroke:#880E4F,color:#fff
    style Logging fill:#9C27B0,stroke:#4A148C,color:#fff
