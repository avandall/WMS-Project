sequenceDiagram
    participant Client
    participant API as Documents Router
    participant Service as Document Service
    participant ProdRepo as Product Repo
    participant WhRepo as Warehouse Repo
    participant Domain as Document Domain
    participant DB as PostgreSQL
    
    Client->>API: POST /documents/import<br/>{warehouse_id, items, created_by}
    
    API->>API: Validate Pydantic Schema
    API->>Service: create_import_document()
    
    Service->>Domain: Validate warehouse_id exists
    Service->>WhRepo: get(warehouse_id)
    WhRepo->>DB: SELECT * FROM warehouses WHERE id=?
    DB-->>WhRepo: Warehouse data
    WhRepo-->>Service: Warehouse object
    
    Service->>Service: Validate all product IDs
    loop For each item
        Service->>ProdRepo: get(product_id)
        ProdRepo->>DB: SELECT * FROM products WHERE id=?
        DB-->>ProdRepo: Product data
        ProdRepo-->>Service: Product object
    end
    
    Service->>Service: Generate document_id
    Service->>Domain: Create Document object
    Domain->>Domain: Validate business rules
    Domain->>Domain: Ensure status = DRAFT
    Domain->>Domain: Validate all items
    
    Domain-->>Service: Valid Document
    Service->>Service: document_repo.save()
    Service->>DB: INSERT INTO documents...<br/>INSERT INTO document_items...
    DB-->>Service: Success
    
    Service-->>API: Document object
    API->>API: Convert to DocumentResponse
    API-->>Client: 201 Created<br/>{document_id, status: DRAFT}
    
    Note over Client,DB: Document is in DRAFT status<br/>No inventory changes yet<br/>Must call POST /documents/{id}/post to execute
